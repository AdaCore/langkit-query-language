let result =
    query p@ParamSpec(any nextSiblings:
                          sib@ParamSpec when priority(sib) > priority(p)
          )

print(result)

fun priority(paramSpec) =
    match paramSpec.mode
        | _ when paramSpec.default_expr is AdaNode => 0
        | ModeOut                                  => 1
        | ModeInOut                                => 2
        | ModeIn                                   => 3
        | ModeDefault                              => 3